<!DOCTYPE html>
<!-- ... (head and body tags are the same) ... -->

    <!-- ... (rest of the HTML is the same until the settings modal) ... -->
    
    <div id="settings-modal" class="modal-backdrop fixed inset-0 z-50 flex items-center justify-center p-4 invisible opacity-0">
         <div class="modal-content w-full max-w-lg rounded-2xl p-6 sm:p-8 transform scale-95 opacity-0 max-h-[90vh] overflow-y-auto">
            <!-- ... (modal header is the same) ... -->
            <div class="space-y-6">
                <!-- ... (Groq API Key input is the same) ... -->
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                     <!-- RE-ENABLED CSS SELECTOR INPUT -->
                     <div><label class="text-sm font-semibold text-[var(--text-secondary)] uppercase tracking-wider mb-2 block">CSS Selector</label><input type="text" id="css-selector" placeholder=".content" class="input-field w-full px-4 py-3 rounded-xl"></div>
                     <div><label class="text-sm font-semibold text-[var(--text-secondary)] uppercase tracking-wider mb-2 block">Source Language</label><select id="lang-select" class="input-field w-full px-4 py-3 rounded-xl appearance-none bg-no-repeat bg-right pr-10" style="..."><option value="chinese">Chinese</option><option value="korean">Korean</option></select></div>
                </div>
                <!-- ... (Glossary inputs are the same) ... -->
            </div>
         </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const elements = {
            // ... (add cssSelectorInput to the cache)
            cssSelectorInput: document.getElementById('css-selector'),
            // ... (rest of the elements are the same)
        };

        // ... (State and LanguageConfig are the same) ...

        async function handleTranslation(url) {
            // ... (this function is the same) ...
            try {
                // ... (we'll modify the getGroqTranslationStream call slightly below)
                // ...
            }
            // ...
        }

        async function getGroqTranslationStream(url) {
            // ... (prompt generation is the same) ...
            const userApiKey = elements.groqKeyInput.value;
            const cssSelector = elements.cssSelectorInput.value.trim(); // Get the selector value

            const response = await fetch('/api/translate', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                // Add the cssSelector to the request body
                body: JSON.stringify({ novelUrl: url, promptData: prompt, userApiKey: userApiKey, cssSelector: cssSelector })
            });

            // ... (rest of the function is the same) ...
        }

        function saveSettings() {
            localStorage.setItem('nt_settings', JSON.stringify({
                key: elements.groqKeyInput.value,
                lang: elements.langSelect.value,
                gloss: elements.glossaryTextarea.value,
                theme: document.documentElement.classList.contains('dark') ? 'dark' : 'light',
                selector: elements.cssSelectorInput.value // Save the selector
            }));
        }

        const settings = JSON.parse(localStorage.getItem('nt_settings') || '{}');
        elements.groqKeyInput.value = settings.key || '';
        elements.langSelect.value = settings.lang || 'chinese';
        elements.glossaryTextarea.value = settings.gloss || '';
        elements.cssSelectorInput.value = settings.selector || '.content'; // Load the selector, default to .content
        
        // ... (rest of the script, including event listeners, is the same) ...
        // Make sure to add the cssSelectorInput to the event listener list for saving
        [elements.groqKeyInput, elements.langSelect, elements.glossaryTextarea, elements.cssSelectorInput].forEach(el => el.addEventListener('change', saveSettings));
    });
    </script>
</body>
</html>
